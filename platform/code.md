# 代码管理

## git管理

我们选择`git`管理代码，使用`gitlab`搭建自己的私有仓库，`gitlab`配置上`git-lfs`，对接`OSS`来管理二进制文件。

我们的git工作流如下：

![](http://resource.luoxianming.cn/a3dM_AOKjyCqQADDRV5ef.png)

#### 版本分支

对于每个版本，我们从主干上建立版本分支，即`version/1.1.0`这种格式。

在打包时，需要注意合并主干上的其他变更。

在完成打包发布后，将修改合并回主干。

版本分支一直记录，以供之后查找版本问题。

#### feature分支

从版本上来`feature`分支，进行具体的开发工作。

`feature`分支在合并后进行删除。

#### 代码检视

在`gitlab`上设置版本分支和主干分支是受保护的分支，只接受`Merge Request`，不接受`push`， 以此要求所有代码提交都要经过代码检视。

即当要在一个版本上开发一个功能时，必须从版本分支上创建一个`feature`分支，完成开发后，以`MR`的方式提交，由另外一个开发者进行代码检视后，才能合并回主干分支。

#### 关于MR合并时的二进制文件

MR合并时，自动附带了二进制文件，这里应该进行优化，对于主干不设置`git-lfs`，对于版本分支才设置`git-lfs`以保存最终打包的生产版本。

但是目前`gitlab`上MR合并时，不能通过`.gitattributes`自动处理不同的配置文件，所以还需要等待其[更新以解决类似问题](https://gitlab.com/gitlab-org/gitlab-ce/issues/35319)， 或者手动处理一下。

## 源码规范

待完善。








